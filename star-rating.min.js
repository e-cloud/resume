/*
Author: Anshu Krishna
Contact: anshu.krishna5@gmail.com
Date: 13-Sep-2019
*/
class StarRating extends HTMLElement{constructor(){super();let t=this.attachShadow({mode:"closed"});t.appendChild(StarRating.__template.content.cloneNode(!0)),Object.defineProperties(this,{__cntr:{enumerable:!1,writable:!1,value:t.querySelector("#cntr")},__painter:{enumerable:!1,writable:!1,value:()=>{let t=this.value,e=this.max,a=getComputedStyle(this),r=a.getPropertyValue("--star-fill-color"),l=a.getPropertyValue("--star-back-color");this.__cntr.innerHTML=StarRating.StarMaker.gen(t,e,r,l),this.__cntr.setAttribute("title",`${t} of ${e}`)}},__onclick:{enumerable:!1,writable:!1,value:t=>{t.stopPropagation();let e=null;switch(t.target.nodeName){case"path":e=t.target.parentNode;break;case"svg":e=t.target}if(null===e)return;let a=1;for(;null!==(e=e.previousSibling);)a++;let r=this.value;r===a?(this.value=0,this.dispatchEvent(new CustomEvent("change",{detail:{old:r,new:0}}))):(this.value=a,this.dispatchEvent(new CustomEvent("change",{detail:{old:r,new:a}})))}}})}get value(){let t=this.getAttribute("value");return null===t?0:parseFloat(t)}get max(){let t=this.getAttribute("max");return null===t?5:parseInt(t)}set value(t){null===t?this.removeAttribute("value"):this.setAttribute("value",parseFloat(t))}set max(t){null===t?this.removeAttribute("max"):this.setAttribute("max",parseInt(t))}connectedCallback(){this.__painter()}static get observedAttributes(){return["value","max","changeable"]}attributeChangedCallback(t,e,a){switch(t){case"value":case"max":this.__painter();break;case"changeable":null===a?(this.__cntr.removeEventListener("click",this.__onclick),this.__cntr.classList.remove("clickable")):(this.__cntr.addEventListener("click",this.__onclick),this.__cntr.classList.add("clickable"))}}}Object.defineProperties(StarRating,{__template:{enumerable:!1,writable:!1,value:document.createElement("template")},StarMaker:{enumerable:!1,writable:!1,value:class{static fullStar(t){let e=document.createElement("span");return e.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 300 300"><path fill="${t}" d="M150 14.3l35.3 101.4 107.4 2.2-85.6 64.9 31.1 102.8L150 224.3l-88.2 61.3 31.1-102.8L7.4 118l107.4-2.2L150 14.3l35.3 101.4z"/></svg>`,e.firstChild}static partialStar(t,e,a){let r=document.createElement("span");return r.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 300 300"><defs><linearGradient id="partial"><stop offset="0%" stop-color="${e}"/><stop offset="${t}%" stop-color="${e}"/><stop offset="${t}%" stop-color="${a}"/><stop offset="100%" stop-color="${a}"/></linearGradient></defs><path fill="url(#partial)" d="M150 14.3l35.3 101.4 107.4 2.2-85.6 64.9 31.1 102.8L150 224.3l-88.2 61.3 31.1-102.8L7.4 118l107.4-2.2L150 14.3l35.3 101.4z"/></svg>`,r.firstChild}static gen(t,e=5,a="red",r="grey"){a=String(a).trim(),r=String(r).trim(),e=parseInt(e);let l=document.createElement("div");if(t>=e)for(let t=0;t<e;t++)l.appendChild(StarRating.StarMaker.fullStar(a));else{let n=parseInt(t),i=parseInt(100*Number(t-n).toFixed(2));for(let t=0;t<n;t++)l.appendChild(StarRating.StarMaker.fullStar(a));0!==i&&(l.appendChild(StarRating.StarMaker.partialStar(i,a,r)),n++);for(let t=n;t<e;t++)l.appendChild(StarRating.StarMaker.fullStar(r))}return l.innerHTML}}}}),StarRating.__template.innerHTML='<style>\n:host {\n\t--star-fill-color: #ffd700;\n\t--star-back-color: #b2b2b2;\n\n\t--star-stroke: none;\n\t--star-stroke-opacity: inherit;\n\t--star-stroke-width: 0.2em;\n\n\tdisplay: inline-block;\n}\nsvg {\n\theight: 1em;\n\twidth: auto;\n}\npath {\n\tstroke: var(--star-stroke);\n\tstroke-opacity: var(--star-stroke-opacity);\n\tstroke-width: var(--star-stroke-width);\n}\n#cntr {\n\tdisplay: flex;\n\tgrid-gap: 0.1em;\n}\n#cntr.clickable svg {\n\tcursor: pointer;\n}\n</style><div id="cntr"></div>',customElements.define("star-rating",StarRating);